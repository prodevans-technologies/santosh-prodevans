Exam Tip:
a) Firewall and Selinux would be disabled. Do not touch firewalld or selinux.
b) There will 5 vms
      ansible.example.com
      node1.example.com
      node2.example.com
      node3.example.com
      node4.example.com
c) Log in as root in ansible.example.com nad then su - ansible as user password is not known
d) Write all your playbook as user ansible in ~/ansible/playbook in ansible.example.com    
   virtual machine
e) All cofiguration changes are to be made in /etc/ansible/ansible.cfg

	# vim /etc/ansible/ansible.cfg
	[defaults]                                                                                                   
	inventory = /opt/ansible/dynamic/inventory                           
	timeout = 60 





1) The inventory was to be set to /opt/ansible/dynamic/inventory and timeout to 60. 
   Once you correctly configured it show group of hosts majori, bunnies, newbunnies. 

	Answer:
	# vim /etc/ansible/ansible.cfg
	
	[defaults]                                                                                                   
	inventory = /opt/ansible/dynamic/inventory                           
	timeout = 60

	# chmod +x /opt/ansible/dynamic/inventory/a_rabbits.py
	# chmod +x /opt/ansible/dynamic/inventory/rabbits1.py
	# mv /opt/ansible/dynamic/inventory/a_rabbits2.py /opt/ansible/dynamic/inventory/rabbits2.py
	# ansible all --list-hosts

1) Dynamic inventory
   
The inventory was to be set to /opt/ansible/dynamic/inventory and timeout to 60. Once you correctly configured it show group of hosts majori, bunnies, newbunnies. 

2) Create /home/ansible/playbook/httpd.yml 
	a) which should install http service
	b) Copy configuration file using get_url http://rhgls/httpd.conf.template 
           to /etc/http/conf/httpd.conf
	c) Change /var/www/html/index.html file using lineinfile module so that it's content
           should be "Hello from nodeX". If the file exists it should not overwrite. 
	d) Start the service of httpd and enable it.

	It may not show the ouput, may show permission denied.

3) Creat a /home/ansible/playbook/httpd-auth.yml file such that 
	a) It creates /var/www/html/private directory
	b) Copy the http://rhgls/htaccess-custom /var/www/html/private/.htaccess
	c) Copy http://rhgls/htpasswd file /var/www/html/private/.htpasswd
	d) Implement appropriate permission so that apache can read them
	e) Replace all instances of 'AllowOverride None' with 'AllowOverride AuthConfig' 
           in /etc/httpd/conf/httpd.conf using replace module
	e) Create /var/www/html/private/index.html to read as This node nodeX is private

	You can test you configuration using username ansible and password ansiansi
	It may not show the ouput, may show permission denied on one or two systems.

4) 4)Create a script file /home/ansible/playbook/adhoc.sh 
	a) This should copy the file /usr/local/bin/runme.sh to /usr/bin/runme.sh on all nodes. 
	b) This should run as user ansible. 
	c) The file should have execute permissions. 

5) Create custom groups named production and backup such that node1 and node2 belongs to production and node3 and node4 belongs to backup.
	 Create a tag.yml which should be able to do the following:-
	a) Create a tarball /var/tmp/production.tar.gz for the production group 
           containing the /var/www/html directory contents when run with tag production.
	b) Create a tarball /var/tmp/backup.tar.gz for the backup group containing the /var/log/httpd directory contents when run with tag backup.

6) Create /home/ansible/playbook/access.yml using block and rescue
	a) It should check http://rhgls/access
	b) If the url is accessible it should create a file named /var/www/html/access.html with the 
           content as “I am accessible”. 	   
	c) Otherwise it should create a file access.html with the content as “I have no access."
		
7) Create a file hostinfo.yml which should store the following system information in 
   /root/hostinfo.txt in a single line 
   
   nodeX processorcount defaultNICIPV4address defaultNICmacaddress 

8) Create ping.yml so that 
	a) It creates /var/www/html/tag1.html in node 1 & 3 with content "I am tag1" when run as
	   ansible-playbook --tags tag1 ping.yml
	b) It creates /var/www/html/tag2.html in node 2 & 4 with content "I am tag2" when run as
	   ansible-playbook --tags tag2 ping.yml

9) a) Create noshutdown.yml that start httpd service based on all nodes. 
   b) shutdown.yml should stop httpd either one of node1 and node 4.
   c) It shoud not process node3 and node 2
	  
10) Create a file saveabort.yml that runs on node1 and node4 
    a) Should create a file /etc/saveabort.txt with content "I am there". 
    b) If this file exists, then it should not allow either overwriting the 
       contents of the file or modifying the file.

   Hint: - hosts: ['node1', 'node4']
  

11) Create roles2install.yml 
      a) Should install role named examfun from url https://rhgls.example.com/files/examfun.tgz

12) Create a playbook createusers.yml that uses the examfun role 
	a) Creates users listed in staff in examfun role and adds them to staff and webclients group
	b) Creates users listed in guest in examfun role to guest and webclients group
	c) Deletes all users in revoke list

13) Create unarchive.yml 
	a) The playbook unarchive.yml uses crypt.yml to for obtaining password 
           for decrypting file downloaded from url http://rhgls.example.com/vault.zip. 
           It uses a command
  	  	unzip -o -P {{ password }}  to unzip vault.zip to /var/www/html 
          where password is drone.
	b) Create encrypted file crypt.yml that contains password of vault.zip and 
	   could be decrypted usuing password ansiansi written in vaultpass

14) Create a failweb.yml file which should 
    a) Try to install package named "ex407-server" and start.
    b) It should display the output of install and service
    d) If intall fails display a message "Installation failed". 
    e) If start the service. if service fails, then it should 
       display a message "Service failed". 
    f) If any of these conditions (installation and Service starting) fails, 
       it should display the message "Playbook was Unsuccessful".

